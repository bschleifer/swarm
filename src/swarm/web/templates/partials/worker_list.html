{% if groups and groups|length > 0 %}
{% for group in groups %}
<div class="group-section{% if group.collapsed %} group-collapsed{% endif %}">
    <div class="group-header" data-group="{{ group.name }}">
        <span class="group-chevron">&#9660;</span>
        <span>{{ group.name }}</span>
        <span class="group-count">
            <span class="state-dot state-dot-sm state-{{ group.worst_state }}"></span>
            {{ group.worker_count }}
        </span>
    </div>
    {% for w in group.members %}
    <div class="worker-item {% if w.name == selected_worker %}selected{% endif %}"
         data-worker="{{ w.name }}" data-pane-id="{{ w.pane_id }}">
        <span class="state-dot state-{{ w.state }}"></span>
        <div>
            <div class="worker-name">{{ w.name }}{% if w.revive_count > 0 %}<span class="revive-badge">x{{ w.revive_count }}</span>{% endif %}</div>
            <div class="worker-meta">{{ w.state }} &mdash; {{ w.state_duration }}s</div>
            {% if worker_tasks and worker_tasks.get(w.name) %}
            <div class="worker-task">{{ worker_tasks[w.name] }}</div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endfor %}
{% if ungrouped %}
{% for w in ungrouped %}
<div class="worker-item {% if w.name == selected_worker %}selected{% endif %}"
     data-worker="{{ w.name }}" data-pane-id="{{ w.pane_id }}">
    <span class="state-dot state-{{ w.state }}"></span>
    <div>
        <div class="worker-name">{{ w.name }}{% if w.revive_count > 0 %}<span class="revive-badge">x{{ w.revive_count }}</span>{% endif %}</div>
        <div class="worker-meta">{{ w.state }} &mdash; {{ w.state_duration }}s</div>
        {% if worker_tasks and worker_tasks.get(w.name) %}
        <div class="worker-task">{{ worker_tasks[w.name] }}</div>
        {% endif %}
    </div>
</div>
{% endfor %}
{% endif %}
{% else %}
{% for w in workers %}
<div class="worker-item {% if w.name == selected_worker %}selected{% endif %}"
     data-worker="{{ w.name }}" data-pane-id="{{ w.pane_id }}">
    <span class="state-dot state-{{ w.state }}"></span>
    <div>
        <div class="worker-name">{{ w.name }}{% if w.revive_count > 0 %}<span class="revive-badge">x{{ w.revive_count }}</span>{% endif %}</div>
        <div class="worker-meta">{{ w.state }} &mdash; {{ w.state_duration }}s</div>
        {% if worker_tasks and worker_tasks.get(w.name) %}
        <div class="worker-task">{{ worker_tasks[w.name] }}</div>
        {% endif %}
    </div>
</div>
{% endfor %}
{% endif %}
{% if not workers %}
<div class="empty-state">
    <div class="empty-state-icon">&#x1f41d;</div>
    <p class="mb-md">No workers found</p>
    <button class="btn" onclick="showLaunch()">Launch Brood</button>
    <p class="help-text mt-sm">Start workers from your config</p>
</div>
{% endif %}
